# PhotoWaterMark 桌面应用产品需求文档(PRD)

## 1. 概述
PhotoWaterMark是一个Windows桌面应用程序，用于向图片添加文本水印。该工具支持多种水印配置选项，提供实时预览功能，并支持模板管理。

## 2. 功能特性

### 2.1 文件处理
#### 2.1.1 导入图片
- 支持单张图片拖拽或通过文件选择器导入
- 支持批量导入，可一次性选择多张图片或直接导入整个文件夹
- 在界面上显示已导入图片的列表（缩略图和文件名）

#### 2.1.2 支持格式
**输入格式：**
- 必须支持：JPEG, PNG
- 强烈建议支持：BMP, TIFF
- PNG格式必须支持透明通道

**输出格式：**
- 用户可选择输出为 JPEG 或 PNG

#### 2.1.3 导出图片
- 用户可指定一个输出文件夹
- 为防止覆盖原图，默认禁止导出到原文件夹
- 提供导出文件命名规则选项：
  - 保留原文件名
  - 添加自定义前缀（如 wm_）
  - 添加自定义后缀（如 _watermarked）

### 2.2 水印类型
#### 2.2.1 文本水印
- 内容：用户可自定义输入任意文本
- 透明度：可调节文本的透明度（0-100%）

### 2.3 水印布局与样式
#### 2.3.1 实时预览
- 所有对水印的调整都应在主预览窗口中实时显示效果
- 用户可以点击图片列表切换预览不同的图片

#### 2.3.2 位置
- 预设位置：提供九宫格布局（四角、正中心），用户可一键将水印放置在这些位置
- 手动拖拽：用户可以直接在预览图上通过鼠标拖拽水印到任意位置

### 2.4 配置管理
#### 2.4.1 水印模板
- 用户可以将当前的水印设置（包括水印内容、字体、颜色、位置、大小、透明度等所有参数）保存为一个模板
- 用户可以加载、管理和删除已保存的模板
- 程序启动时可自动加载上一次关闭时的设置或一个默认模板

## 3. 技术要求

### 3.1 应用类型
- Windows桌面应用程序
- 可直接下载使用的.exe文件
- 支持Windows 7及以上版本

### 3.2 支持的图像格式
- JPEG (主要支持格式)
- PNG (主要支持格式，支持透明通道)
- BMP (建议支持格式)
- TIFF (建议支持格式)

### 3.3 用户界面
- 图形用户界面(GUI)
- 主窗口包含：
  - 图片导入区域
  - 图片列表显示区域（带缩略图）
  - 水印设置面板
  - 实时预览窗口
  - 导出设置区域
  - 模板管理区域

### 3.4 核心功能模块
- 文件导入与管理模块
- 图像处理与水印添加模块
- 实时预览模块
- 模板管理模块
- 配置存储模块

## 4. 用户交互流程
1. 启动应用
2. 导入图片（单张/批量/文件夹）
3. 在预览窗口中调整水印设置
4. 实时查看水印效果
5. 保存为模板（可选）
6. 设置导出选项
7. 执行导出操作

## 5. 错误处理
- 无效的文件路径
- 不支持的图像格式
- 文件读写权限问题
- 图像处理时内存不足
- 模板保存/加载失败
- 导出路径冲突

## 6. 依赖项
- Python 3.8 或更高版本
- 图像处理库 (Pillow)
- GUI框架 (PyQt5/PySide2 或 tkinter)
- 打包工具 (PyInstaller)